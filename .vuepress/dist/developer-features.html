<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Developer Features | Documentation, Tutorials and Help Resources | Smartloop</title>
    <meta name="description" content="Grow Your Business with AI-Powered Conversations">
    
    
    <link rel="preload" href="/assets/css/10.styles.e96a352e.css" as="style"><link rel="preload" href="/assets/js/app.b6aafca7.js" as="script"><link rel="preload" href="/assets/js/5.738957cb.js" as="script"><link rel="prefetch" href="/assets/js/0.c15a6765.js"><link rel="prefetch" href="/assets/js/1.ba75c142.js"><link rel="prefetch" href="/assets/js/2.080c598d.js"><link rel="prefetch" href="/assets/js/3.9f0589e4.js"><link rel="prefetch" href="/assets/js/4.ba89aa3a.js"><link rel="prefetch" href="/assets/js/6.453a6f0e.js"><link rel="prefetch" href="/assets/js/7.73bc781b.js"><link rel="prefetch" href="/assets/js/8.22201ba6.js"><link rel="prefetch" href="/assets/js/9.dedd2524.js">
    <link rel="stylesheet" href="/assets/css/10.styles.e96a352e.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      Documentation, Tutorials and Help Resources | Smartloop
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="https://dashboard.smartloop.ai" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dashboard
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://blog.recime.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><!----></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="https://dashboard.smartloop.ai" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Dashboard
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><div class="nav-item"><a href="https://blog.recime.io" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Blog
  <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></div><!----></nav><ul class="sidebar-links"><li><a href="/" class="sidebar-link">Home</a></li><li><a href="/getting-started.html" class="sidebar-link">Getting Started</a></li><li><a href="/chatbot-concepts.html" class="sidebar-link">Chatbot Concepts</a></li><li><a href="/building-a-bot.html" class="sidebar-link">Building a Bot</a></li><li><a href="/publish.html" class="sidebar-link">Publishing a Bot</a></li><li><a href="/broadcasting.html" class="sidebar-link">Broadcasting (Push Notifications)</a></li><li><a href="/monitor.html" class="sidebar-link">Monitoring a Bot</a></li><li><a href="/developer-features.html" class="active sidebar-link">Developer Features</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/developer-features.html#json-api" class="sidebar-link">JSON API</a></li><li class="sidebar-sub-header"><a href="/developer-features.html#script-block" class="sidebar-link">Script Block</a></li><li class="sidebar-sub-header"><a href="/developer-features.html#working-with-variables" class="sidebar-link">Working with Variables</a></li><li class="sidebar-sub-header"><a href="/developer-features.html#capturing-user-location" class="sidebar-link">Capturing User Location</a></li></ul></li><li><a href="/resources.html" class="sidebar-link">Resources</a></li></ul></div><div class="page"><div class="content"><h1 id="developer-features"><a href="#developer-features" aria-hidden="true" class="header-anchor">#</a> Developer Features</h1><h2 id="json-api"><a href="#json-api" aria-hidden="true" class="header-anchor">#</a> JSON API</h2><p>The plugin allows you to create server-side integrations or define your conversation logic based on dynamic content. You can make the following HTTP requests:</p><ul><li>GET</li><li>POST</li><li>PATCH</li><li>DELETE</li><li>PUT</li></ul><p>In addition, you can pass query string parameters, POST body, and headers to address a various type of custom implementation. It is possible to use user variables as parameters using the double braces syntax to pass user input and NLP response. Here is an example of how to use JSON API in order to pull data from a third-party API:</p><p><img src="/assets/img/json-api.bee53245.png" alt></p><p>The response is saved in  variable. This can be used inside the text element to print out the result in the following way:</p><p><img src="/assets/img/json-reply.06f2a9d3.png" alt></p><p>JSON API allows you to implement the following use-cases:</p><ol><li>Retrieve dynamic content.</li><li>Create server-side integrations, where it will send data to an endpoint whenever a conversation reaches a certain point.</li><li>Trigger an event.</li></ol><h2 id="script-block"><a href="#script-block" aria-hidden="true" class="header-anchor">#</a> Script Block</h2><p>Script Block allows you to quickly write custom logic inside the conversation builder. Click on <code>script</code> button in the toolbar as shown below to insert a script block:</p><p><img src="/assets/img/script-block.d79afc33.png" alt></p><p>The entire conversation context is available in the script block. This will let you write custom logic based on user input, entities and variables. The example below shows how to pull data from a weather API and then set it as a context variable for use in the builder:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token comment">//script block</span>
<span class="token comment">//https://docs.recime.io/script-block.html</span>
<span class="token keyword">import</span> request <span class="token keyword">from</span> <span class="token string">'request'</span><span class="token punctuation">;</span>

<span class="token comment">// get a free API key from openweathermap.org</span>
<span class="token keyword">const</span> appId <span class="token operator">=</span> <span class="token string">'PASTE_YOUR_API_KEY'</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">handler</span> <span class="token operator">=</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> done<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
        url <span class="token punctuation">:</span> <span class="token string">'https://api.openweathermap.org/data/2.5/weather'</span><span class="token punctuation">,</span>
        qs <span class="token punctuation">:</span> <span class="token punctuation">{</span>
            lat <span class="token punctuation">:</span> context<span class="token punctuation">.</span>nlp<span class="token punctuation">.</span>entities<span class="token punctuation">.</span>location<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>lat<span class="token punctuation">,</span>
            lon <span class="token punctuation">:</span> context<span class="token punctuation">.</span>nlp<span class="token punctuation">.</span>entities<span class="token punctuation">.</span>location<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>lng<span class="token punctuation">,</span>
            appid<span class="token punctuation">:</span> appId<span class="token punctuation">,</span>
            units<span class="token punctuation">:</span> <span class="token string">'imperial'</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        json <span class="token punctuation">:</span> <span class="token boolean">true</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>err<span class="token punctuation">,</span> reponse<span class="token punctuation">,</span> body<span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
        <span class="token comment">//debug</span>
        console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>body<span class="token punctuation">)</span><span class="token punctuation">;</span>
     
        <span class="token comment">// save </span>
        context<span class="token punctuation">.</span>vars<span class="token punctuation">.</span><span class="token keyword">set</span><span class="token punctuation">(</span><span class="token string">&quot;weatherData&quot;</span><span class="token punctuation">,</span> body<span class="token punctuation">)</span><span class="token punctuation">;</span>
        
        <span class="token function">done</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

</code></pre></div><p><code>context</code> parameter have the following properties:</p><table><thead><tr><th>Property Name</th><th>Description</th></tr></thead><tbody><tr><td>args</td><td>[User input]</td></tr><tr><td>nlp</td><td>Contains entities and intents for an expression.</td></tr><tr><td>vars</td><td>Set or get vars to use in the current context.</td></tr></tbody></table><p>The <code>args</code> object contains the following properties:</p><table><thead><tr><th>Property Name</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>sender</td><td>Unique sender ID</td><td>String</td></tr><tr><td>text</td><td>Input text.(e.g. Where is San Francisco?)</td><td>String</td></tr><tr><td>event</td><td>Event to trigger an intent. Either text or event is required.</td><td>Object</td></tr></tbody></table><p><code>event</code> contains the name of the event that is triggered for a user action:</p><table><thead><tr><th>Property Name</th><th>Description</th><th>Type</th></tr></thead><tbody><tr><td>name</td><td>Name of the event (e.g. start) that corresponds to an intent name</td><td>String</td></tr></tbody></table><p>You can use variables inside the builder in the following way using the double braces syntax:</p><p><img src="/assets/img/context-vars.b1caf032.png" alt></p><p>You can also output in script block using the <a href="https://github.com/Recime/recime-bot-extension" target="_blank" rel="noopener noreferrer">extension module<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> in the following way:</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">import</span> Ext <span class="token keyword">from</span> <span class="token string">&quot;recime-bot-extension&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> __ <span class="token operator">=</span> Ext<span class="token punctuation">.</span><span class="token keyword">default</span><span class="token punctuation">;</span>

exports<span class="token punctuation">.</span><span class="token function-variable function">handler</span> <span class="token operator">=</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> done<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">done</span><span class="token punctuation">(</span>__<span class="token punctuation">.</span><span class="token function">text</span><span class="token punctuation">(</span><span class="token string">&quot;Hello world&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>Script block can be useful in the following scnearios:</p><ul><li>Retrieving data from your existing API that you want inject in your conversation context.</li><li>Construct dynamic response based on user input and entities.</li></ul><p>The following libraries are available in the <strong>Script Block</strong> runtime:</p><ul><li><a href="https://nodejs.org/api/modules.html#modules_core_modules" target="_blank" rel="noopener noreferrer">node core<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://github.com/request/request" target="_blank" rel="noopener noreferrer">request<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://github.com/Recime/recime-bot-extension" target="_blank" rel="noopener noreferrer">recime-bot-extension<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://github.com/Recime/recime-keyvalue-store" target="_blank" rel="noopener noreferrer">recime-keyvalue-store<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li><li><a href="https://momentjs.com/" target="_blank" rel="noopener noreferrer">moment.js<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul><h2 id="working-with-variables"><a href="#working-with-variables" aria-hidden="true" class="header-anchor">#</a> Working with Variables</h2><p>Use variables to specify a check-point in your conversation or identify a user. You can access a variable using the <strong>double braces</strong> syntax in the following way:</p><p><img src="/assets/img/facebook-variable.cd87a515.png" alt></p><p>Here is a list of varaibles accessible from with the conversation scope by channel:</p><table><thead><tr><th>Platform</th><th>Variable name</th><th>comments</th></tr></thead><tbody><tr><td>Facebook</td><td>first_name, last_name, profile_pic, gender, locale, timezone</td><td>--</td></tr><tr><td>WeChat</td><td>first_name</td><td><code>nickname</code> and set as first_name</td></tr><tr><td>Viber</td><td>first_name, last_name</td><td>--</td></tr><tr><td>Telegram</td><td>first_name, last_name</td><td>--</td></tr><tr><td>Website</td><td>first_name, last_name</td><td>You can override them from the configure section</td></tr></tbody></table><div class="tip custom-block"><p class="custom-block-title">How to track an user?</p><p>You can use the <code>sender</code> variable to track a user specific to a channel.</p></div><p>It is also possible to create your own custom variables using <code>User Variable</code> plugin.</p><p><img src="/assets/img/user-variable.8aa74062.png" alt></p><p>Use variables to trigger a conditional flow as shown below:</p><p><img src="/assets/img/user-variable-goto.354f139b.png" alt></p><p>Use variables as filter criteria to send a broadcast (a.k.a. push notifications) to a specific number of subscribers:</p><p><img src="/assets/img/variable-broadcast.5d83a620.png" alt></p><h2 id="capturing-user-location"><a href="#capturing-user-location" aria-hidden="true" class="header-anchor">#</a> Capturing User Location</h2><p>In order to offer location-aware content, promotions to your users, your bot can capture location as user input.</p><p>In order to capture a user location, create a &quot;location&quot; block. Location is sent as an user input and can be accessed as a variable in the following way:</p><p><img src="/assets/img/location-new.a0fad47d.png" alt></p><p><code>args.location</code> contains the following properties:</p><table><thead><tr><th>Name</th><th>Description</th></tr></thead><tbody><tr><td>lat</td><td>latitude</td></tr><tr><td>long</td><td>longitude</td></tr></tbody></table><p>You can use this variable in <code>JSON API</code> plugin as POST or query string parameter to offer specific content from your database or capture location as part of qualifying a user.</p><div class="tip custom-block"><p class="custom-block-title">How to send a location to the bot?</p><p>A user can send location in the following way for messenger platform:</p><p><a href="https://www.facebook.com/help/messenger-app/1394730427523556" target="_blank" rel="noopener noreferrer">How can I send my current location in Messenger<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p><p>In Viber, it is available as a toolbar button, clicking on it will bring up the map to pin your location:</p><p><img src="/assets/img/location-viber.9d8dbe59.jpeg" alt></p><p>In Telegram, tap on the attachment button and choose Location:</p><p><img src="/assets/img/share-location-telegram-1.6d328420.png" alt></p></div></div><div class="page-edit"><!----><div class="last-updated"><span class="prefix">Last Updated: </span><span class="time">9/23/2018, 10:46:48 AM</span></div></div><div class="page-nav"><p class="inner"><span class="prev">
        ← <a href="/monitor.html" class="prev">
          Monitoring a Bot
        </a></span><span class="next"><a href="/resources.html">
          Resources
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/5.738957cb.js" defer></script><script src="/assets/js/app.b6aafca7.js" defer></script>
  </body>
</html>
